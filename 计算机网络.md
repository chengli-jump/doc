# 协议层次及服务类型
## 1.1 OSI七层模型

OSI模型全程称为开放式通信系统互连参考模型

物联网淑惠试用
物-物理层
联-数据链路层
网-网络层
淑-传输层
惠-会话层
试-表示层
用-应用层

## 1.2 TCP/IP四层模型

数据链路层(对应osi的物理层和数据链路层)
网络层(对应osi网络层)
传输层                                
应用层(对应osi的会话，表示，应用层)    
 
应用层协议一般有：http，DNS；
传输层协议：TCP(传输控制协议),UDP(用户数据报协议),其中面向连接的TCP协议保证数据传输可靠性，面向无连接的UDP协议能够实现数据包简单、快速传输；
## 1.3TCP/IP五层模型
五层协议的体系结构只是为介绍网络原理而设计的，实际应用还是 TCP/IP 四层体系结构。

物-物理层
联-数据链路层
网-网络层
淑-传输层
用-应用层(对应osi的上三层)


# 在浏览器地址输入一个URL后回车，背后会进行哪些技术步骤?

域名解析；
发起TCP的三次握手；
建立TCP连接后发起http请求；
服务器响应http请求，浏览器得到html代码；
浏览器解析html代码，并请求html代码中的资源(如js，css，图片等)；
浏览器对页面进行渲染并显示；

# 应用层


## 1.DNS是什么?

DNS是域名系统，作为域名和IP地址相互映射的一个分布式数据库；

让用户更方便的访问互联网，而不用记录ip地址；

## 2.DNS的工作原理？
DNS属于应用层协议，可以将主机域名转换为ip地址，使用UDP传输；

之所以使用UDP传输，是因为UDP传输速度快，TCP传输要经过三次握手，然后发送数据和应答，最后四次挥手；

# 传输层

## 1.为什么需要三次握手，两次不行吗?

三次握手：
刚开始客户端处于closed状态，服务器处于listen状态；
第一次握手：主机1向主机二发送初始的SEQ，首次连接请求的关键字是SYN，表示收发数据前同步传输消息，此时报文的ACK一般为空(说明客户端发送是正常的)(客->SYN_SEND);
第二次握手：主机2收到报文后,给主机1发送消息，用一个新的SEQ表示自己的序号，然后ACK代表已经接收到主机1的消息,希望接收下一个消息(ACK为对方的SEQ+收到字节+1) (说明服务端的收发正常)(服->SYN_RECV)
第三次握手：主机1收到主机2的确认后，还需要给主机2确认，此时再发送一个SEQ和ACK(说明客户端的接收正常)；
服务器收到ACK报文后，表示三次握手建立完成；(客->ESTABLISH,服->ESTABLISH)

三次握手的原因是为了确认双方的收发是否都正常，只有两次的并不能保证。

SEQ:收发数据前后向数据包分配序号，是为了防止数据丢失(可在数据丢失时马上查看并重传丢失数据包)；


## TCP比UDP慢的原因
1.收发数据前后需要进行建立和断开连接；
2.收发数据过程中为保证可靠性添加流控制(滑动窗口机制)

## 2.为什么需要四次挥手，三次不行吗？

四次握手:
第一次挥手：客户端发送FIN报文，指定一个初始序列号(seq_num=q)。(客->FIN_WAIT1);
第二次挥手：服务器收到FIN后，发送ACK报文，并把客户端的序列号值+1作为ACK报文的序列号值(ACK_NUM=q+1),
表明收到了客户端的报文。(服->CLOSE_WAIT,客->FIN_WAIT2)；
第三次挥手: 如果服务端也想断开连接，会发送一个FIN报文，指定一个初始化序列号(seq_num=K)(服->LAST_ACK, 客->TIME_WAIT);
第四次挥手：客户端收到FIN后，发送一个ACK报文，并把服务端的序列号值+1作为ACK报文的序列号值(ACk_NUM=k+1)。(服务端->CLOSED);

第四次挥手客户端发送ACK报文后，没有直接关闭(TIME_WAIT),而是等一阵子才关闭？
确保服务端收到ACK报文，如果没收到，服务端重发FIN报文给客户端，客户端收到FIN报文后知道之前的ACK报文丢失，重发ACK；

为什么挥手是四次？
TCP是双工通信，发送方和接收方都需要FIN和ACK报文，连接都需要单独关闭。


## 3.TCP和UDP有哪些区别? 各自的应用场景？

TCP协议的特点：
1.TCP是面向连接的传输层协议；面向连接就是值双方传输数据之前必须先建立一条通道，比如三次握手和四次挥手分别就是建立通道和销毁通道的过程；
2.每条TCP连接只能有两个端点(两个套接字),只能点对点；
3.TCP传输可靠；

TCP传输可靠性的原理:
可靠传输的两个特点：
a.不管发送方传输速度如何，接收方都能及时处理收到的数据；
b.传输通道无差错，保证传输数据的正确；

1.首先是采用三从握手，四次挥手分别建立和释放TCP连接，从而保证建立的传输通道是可靠；
2.TCP采用超时重传等机制保证数据传输的正确性，还是用了滑动窗口协议进行流量控制；
3.TCP采用慢开始，拥塞避免等来进行拥塞控制，避免网络阻塞；

慢开始:先试探网络拥塞的程度再**逐渐增大拥塞窗口**，每次收到确认后将拥塞窗口翻倍，直到达到阈值；
拥塞避免：达到阈值后每次以一个MSS为单位增长拥塞窗口大小，当发生拥塞(超时未收到确认)，将阈值降为原来的一半，继续执行线性增长。

UDP协议的特点:
1.UDP是面向无连接的传输协议；
2.UDP支持一对一，一对多，多对多通信；
3.UDP传输速率快，但传输不可靠；



TCP和UDP区别:
1.TCP是面向连接，UDP是面向无连接；
2.TCP保证传输可靠，UDP传输不可靠;
3.TCP有流量控制和拥塞控制，UDP没有；


TCP和UDP常用协议:
TCP:HTTP,HTTPS,FTP...
UDP:DSN，DHCP...

TCP和UDP应用场景:

TCP主要应用于对效率要求不高，准确性要求高的场景，比如文件传输，接受邮件等；
UDP主要应用于准确性要求相对较低，效率要求高的场景，比如语音通话，在线视频等即时通讯等；

## 4.HTTP1.0， 1.1， 2.0的版本区别

HTTP1.0规定浏览器与服务器保持短暂的连接，浏览器每次请求都需要与服务器建立一个TCP连接，服务器完成请求后立即断开连接；

HTTP1.1引入持久连接，TCP连接默认不关闭，可以被多个请求复用；

HTTP2.0采用多路复用，即在一个连接里，客户端和服务端都可以同时发送多个请求或回应 ，而不是按顺序对应。

## 5.POST和GET有哪些区别?

get是请求数据，而post是发送数据；
get的请求数据在url中，不安全，而post把数据放在http的请求体中；



## 6.HTTP哪些常用的状态码和使用场景？
状态码分类：
1xx：表示目前是协议中间状态，还需要后续请求；
2xx：表示请求成功；
3xx：表示重定向状态，需要重新请求；
4xx：表示请求报文错误；
5xx：服务端错误；

常用状态码:
101 切换请求协议，从HTTP切换到WebSocket;
200 请求成功；
301 永久重定向，会缓存；
302 临时重定向，不会缓存；
404 资源未找到；
400 请求错误；
500 服务端错误；
503 服务器繁忙；

## 7.HTTP状态码301和302的区别和用途；
301永久重定向,指页面永久性的转移，表示为资源或页面永久性地转移到另一个位置，是网址重定向最为常用的方法
302临时重定向，指页面暂时性的转移；

301常用语网页开发过程中，需要调整网站目录结构，将网页转移到一个新地址；
302常被用作网址劫持；

## 8.在交换过程中如果数据传送完毕，还不想断开连接，怎么维持？

在HTTP中响应体的Connection字段指定为keep-alive
connection：keep-alive

## 9.TCP如何保证有效传输？

连接管理：三次握手，四次挥手；
超时重传：没有收到ACK报文就重新发送数据；
流量控制(滑动窗口)：根据接收端窗口大小改变自己的发送速度；
拥塞控制：慢启动+拥塞避免，快速重传，快速恢复。


## 10.讲一讲网络的五层模型，每一层的职责？

物理层：主要负责在物理线路上传输原始的二进制数据；
数据链路层：指定一套规则协议来进行0,1的传送，让计算机能够理解；
网络层：负责对??间的数据包进?路由选择。此外，?络层还可以实现拥塞控制、?际互
连等功能。在这?层，数据的单位称为数据包（packet）。
传输层：传输层是建立端口到端口的通信，相比网络层的功能是建立主机到主机的通信；传输层
最常见的两大协议是TCP协议和UDP协议；
应用层：为应用程序提供服务；

## 11.简单说一下HTTPS和HTTP的区别？

HTTP协议运行在TCP之上，明文传输；HTTPS相比HTTP多了一层SSL(secure socket layer)协议，是添加了加密和认证机制的HTTP；
此外两者端口不同,HTTP默认80端口，HTTPS默认443端口；
和HTTP通信相比，HTTPS通信由于加密处理消耗更多的CPU和内存；
HTTPS通信需要证书；

## 12.对称加密和非对称加密的区别?

对称加密是指加密和解密使用同一个密钥的方式，这种方式的最大问题是如何确保密钥安全发送给对方；
非对称加密采用两个密钥，一般是使用公钥进行加密，私钥进行解密；
对称加密解密的速度较快，安全性较低，非对称加密解密的速度更慢，安全性更高。


## 13.简单说一下每一层对应的网络协议?

物理层
数据链路层
网络层：网际协议:IP, 地址转换协议:ARP, Internet控制报文协议等；
传输层：传输控制协议:TCP，用户数据报文协议:UDP;
应用层: 超文本传输协议:Https，文本传输协议:FTP, 域名系统:DNS，
安全外壳协议:SSH;
Https协议在Http基础上，添加了SSL/TLS握手以及加密传输；



## 14.地址转换协议ARP工作原理?

在OSI七层模型中，第三层网络层负责IP地址,第二层数据链路层富足MAC地址。
MAC地址也叫物理地址，ARP协议是地址解析协议是通过解析IP地址得到MAC地址，
所以ARP协议在网络层被应用，它是网络层与链路层连接的重要枢纽。


## 15.TCP的主要特点是什么?

1.TCP是面向连接的；
2.每一条TCP连接只能有两个端口，每一条TCP连接都是1对1的；
3.TCP传输是可靠的。通过TCP连接传送数据，无差错，不丢失，不重复，并且按序到达；
4.TCP提供全双工通信。TCP允许通信双方的应用进程在任何时候都能发送数据。TCP连接的两端都
设有发送缓存和接收缓存，用来临时存放双方通信的数据；
5.面向字节流；


## 16.TCP和UDP分别对应的常见应用协议有哪些?
1.TCP对应的应用层协议
FTP:定义文件传输协议，使用21端口；用于文件传输服务，比如下载文件，上传主页等；
Telnet:一种用于远程登陆的协议。
SMTP:定义了简单邮件传送协议；
HTTP：文本传输协议，从Web服务器传输超文本到本地浏览器的传送协议

2.UDP对应的应用层协议
DNS:域名系统协议，用于域名解析服务，将域名地址转换IP地址；
SNMP：简单网络管理协议，使用161端口，用来管理网络设备；
TFTP：简单文件传输协议，在端口69上使用UDP协议

## 17.为什么TIME-WAIT状态必须等待2MSL的时间呢?

MSL-Maximum Segment Lifetime,报文最大生成时间，它是任何报文在网络上存在的最长时间，超过这个时间
报文将被丢弃。2MSL其实相当于允许报文丢失一次；

为了确保客户端发送的最后一个ACK报文能够到达服务端。这个ACK报文段可能丢失，因而使处在LAST-ACK状态的服务端收不到对已发送的FIN+ACK报文段确认。服务端会重传这个FIN+ACK报文段，而客户端会在2MSL时间内收到这个重传的FIN+ACK报文段的确认。接着客户端重传一次ACK+FIN报文段，重新启动2MSL计时器。

## 18.保活计时器的作用?

保活计时器能在客户端发生故障的场景关闭连接；
服务器每收到一次客户的数据，就重新设置保活计时器，时间设置通常是两个小时。若两个小时都没有收到客户端
的数据，服务端就发送一个探测报文，间隔75s发送一次，若连续发送10个探测报文段仍然无客户端的响应，
服务端认为客户端故障，关闭连接

## 19.TCP协议如何保证可靠传输?

1.数据报校验：目的是检测数据在传输过程中的任何变化，若校验包出错，则丢失报文段并且给出响应，这时TCP发送数据端超时后会重发数据；
2.对失序数据包重排序；
3.丢弃重复数据；
4.应答机制：当TCP收到来自TCP连接另一端的数据，它将发送一个确认。这个确认不是立即发送，通常延迟几分之一秒；
5.超时重发: 当TCP发出一个段后，启动一个定时器，等待目的端收到这个报文。如果不能及时收到一个确认，将重发这个报文；
6.流量控制: TCP连接的每一方都有固定大小的缓冲空间。TCP的接收端只允许另一端发送自己所能接纳的数据，这样可以防止缓存区溢出，这就是流量控制；
TCP使用的流量控制协议是可变大小的滑动窗口协议。

## 20.谈谈你对停止等待协议的理解？

停止等待协议是为了实现可靠传输，基本原理是每发完一个分组就停止发送，等待对方确认

## 21.谈谈你对ARQ协议的理解？

自动重传请求ARQ协议:
停止等待协议中超时重传是指只要超过一一段时间仍然没有收到确认，就重传发送过的分组(认为刚发送的分组丢失)。因此每发送完一个分组需要设置一个
超时定时器，其重传时间应该比数据在分组传输的平均往返时间更长一些。
连续ARQ协议:
连续ARQ协议可提高信道利用率。发送方维持一个发送窗口，凡是位于发送窗口内的分组可以连续发送出去，而不需要等待对方确认。接收方一般采用累计确认
，当按序到达的最后一个分组到达后发送确认，表明所有分组确认收到；

## 22.谈谈你对滑动窗口的了解?

TCP利用滑动窗口实现流量控制的机制，主要是为了解决网络拥塞状况，导致节点阻塞掉包，双方都无法发送数据这一情况；
TCP采用滑动窗口来进行传输控制，滑动窗口的大小意味着接收方还有多大的缓存区可以用于接收数据，发送方可以通过滑动
窗口的大小来确认应该发送多少字节的数据；


## 23.谈一下你对流量控制的理解?
TCP利用滑动窗口实现流量控制。流量控制是为了控制发送方发送速率，保证接收方来得及接收。接收方发送的确报文中的窗口字段可以用来
控制发送方窗口的大小，从而影响发送方的发送速率；


## 24.谈谈你对TCP拥塞控制的理解？使用了哪些算法?


## 25.什么是粘包?
在使用TCP传输数据时，一个数据包中包含了发送端的两个数据包的信息；

## 26.TCP粘包是怎么产生的?

有两种情况
1.发送方产生粘包:
采用TCP传输时，当发送的数据包过小时，TCP协议默认启动Nagle算法，将这些小的数据包进行合并发送；这个合并过程是在发送方的缓存区进行的，即发送之前
已经粘包了；

2.接收方产生粘包:
当数据传入接收方时，传输层的TCP协议将其放到接收方的缓冲区，然后由应用层主动获取；
当放入缓冲区的速度大于应用层拿数据的速度时会产生粘包。

## 27.如何解决拆包和粘包？

## 28.forward和redirect的区别?

forward和redirect代表两种请求转发方式：直接转发和间接转发；
直接转发相当于,A向B发送求请求，B没有资源，B就会向C发送请求，然后再返回消息给A；
间接转发相当于，A向B发送请求，B没有资源，A又向C发送请求；


## 29.HTTP方法拥有哪些?
1.GET:获取资源；
2.HEAD:获取报文首部；
3.POST：传输实体主体；
4.PUT：上传文件；
5.PATCH：对资源进行部分修改
......

## 30.在浏览器中输入URL地址到显示主页的过程？

1.DNS域名解析：浏览器查询DNS，获取域名对应的IP地址；
2.TCP连接：浏览器获得域名对应的IP地址后，浏览器向服务器请求建立连接，发起三次握手；
3.发送HTTP请求：TCP连接建立起来后，浏览器向服务器发送HTTP请求；
4.服务器处理请求并返回HTTP报文；
5.浏览器解析渲染页面；
6.连接结束；

## 31.DNS解析过程?

## 32.谈下你对HTTP长连接和短连接的理解？分别应用于哪些场景?

在HTTP/1.1之前默认使用短连接。客户端和服务器每进行一次HTTP操作，就建立一次连接，任务结束就中断；
从HTTP/1.1起默认使用长连接，当一个网页打开完成后，客户端和服务器之间的TCP连接不会关闭，客户端在此访问服务器时，会继续使用之前建立好的TCP连接；
长连接适用于交互频繁，点对点通信，如实时通信，网络游戏等；
短连接适用于用户量巨大的web网站，不然数量巨大的客户端一直长连接会给服务器带来巨大的负载；


## 33.HTTPS的工作过程

## 34.HTTP和HTTPS的区别？
1.开销：HTTPS协议需要申请CA申请证书；
2.HTTP协议是运行在Tcp之上的，明文传输；HTTPS相比HTTP多了一层SSL(secure socket layer)协议加密传输，是添加了加密和认证机制的HTTP；


## 35.HTTPS的优缺点


# 物理层和数据链路层

# 1.以太网协议，MAC地址，MTU





